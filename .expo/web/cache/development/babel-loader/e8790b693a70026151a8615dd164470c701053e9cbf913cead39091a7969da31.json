{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState } from 'react';\nimport MapView, { Marker } from 'react-native-maps';\nimport { requestForegroundPermissionsAsync, getCurrentPositionAsync } from 'expo-location';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport View from \"react-native-web/dist/exports/View\";\nimport { useEffect } from 'react';\nimport { api } from \"../../lib/axios\";\nimport io from 'socket.io-client';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport function Map() {\n  var socket = io('http://192.168.3.6:3000');\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    location = _useState2[0],\n    setLocation = _useState2[1];\n  var _useState3 = useState([]),\n    _useState4 = _slicedToArray(_useState3, 2),\n    userOn = _useState4[0],\n    setUserOn = _useState4[1];\n  function requestLocationPermission() {\n    return _requestLocationPermission.apply(this, arguments);\n  }\n  function _requestLocationPermission() {\n    _requestLocationPermission = _asyncToGenerator(function* () {\n      var _yield$requestForegro = yield requestForegroundPermissionsAsync(),\n        granted = _yield$requestForegro.granted;\n      if (granted) {\n        var currentPosition = yield getCurrentPositionAsync();\n        setLocation(currentPosition);\n      }\n    });\n    return _requestLocationPermission.apply(this, arguments);\n  }\n  useEffect(function () {\n    socket.on('searchProfessionals', _asyncToGenerator(function* () {\n      var professionals = yield api.get('/getProfessionalsOn');\n      setUserOn(professionals.data);\n    }));\n    requestLocationPermission();\n  }, []);\n  return _jsx(View, {\n    style: styles.container,\n    children: location && userOn && _jsxs(MapView, {\n      style: styles.map,\n      region: {\n        latitude: location.coords.latitude,\n        longitude: location.coords.longitude,\n        latitudeDelta: 0.0143,\n        longitudeDelta: 0.00134\n      },\n      loadingEnabled: true,\n      zoomEnabled: false,\n      children: [_jsx(Marker, {\n        coordinate: {\n          latitude: location.coords.latitude,\n          longitude: location.coords.longitude\n        },\n        pinColor: \"blue\"\n      }), userOn.map(function (user) {\n        return _jsx(Marker, {\n          coordinate: {\n            latitude: user.tb_profissional_latitude,\n            longitude: user.tb_profissional_longitude\n          },\n          title: user.tb_profissional_nome\n        }, user.tb_profissional_id);\n      })]\n    })\n  });\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1\n  },\n  map: {\n    width: '100%',\n    height: '100%'\n  }\n});","map":{"version":3,"names":["React","useState","MapView","Marker","requestForegroundPermissionsAsync","getCurrentPositionAsync","StyleSheet","View","useEffect","api","io","jsx","_jsx","jsxs","_jsxs","Map","socket","_useState","_useState2","_slicedToArray","location","setLocation","_useState3","_useState4","userOn","setUserOn","requestLocationPermission","_requestLocationPermission","apply","arguments","_asyncToGenerator","_yield$requestForegro","granted","currentPosition","on","professionals","get","data","style","styles","container","children","map","region","latitude","coords","longitude","latitudeDelta","longitudeDelta","loadingEnabled","zoomEnabled","coordinate","pinColor","user","tb_profissional_latitude","tb_profissional_longitude","title","tb_profissional_nome","tb_profissional_id","create","flex","width","height"],"sources":["C:/glia/localizacao/GliaApp/src/utils/Map/index.tsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport MapView, { Marker } from 'react-native-maps';\r\nimport {\r\n    requestForegroundPermissionsAsync,\r\n    getCurrentPositionAsync,\r\n    LocationObject\r\n} from 'expo-location';\r\nimport { StyleSheet, View } from 'react-native';\r\nimport { useEffect } from 'react';\r\nimport { api } from 'src/lib/axios';\r\nimport io from 'socket.io-client';\r\n\r\n\r\n\r\nexport function Map() {\r\n\r\n    const socket = io('http://192.168.3.6:3000');\r\n\r\n    const [location, setLocation] = useState<LocationObject | null>(null);\r\n    const [userOn, setUserOn] = useState<\r\n        {\r\n            tb_profissional_id: number;\r\n            tb_profissional_rua: string;\r\n            tb_profissional_longitude: number;\r\n            tb_profissional_latitude: number;\r\n            tb_profissional_nome: string;\r\n        }[]\r\n    >([]);\r\n\r\n    async function requestLocationPermission() {\r\n        const { granted } = await requestForegroundPermissionsAsync();\r\n\r\n        if (granted) {\r\n            const currentPosition = await getCurrentPositionAsync()\r\n            setLocation(currentPosition);\r\n        }\r\n    }\r\n\r\n       useEffect(() => {\r\n\r\n        socket.on('searchProfessionals', async () => {\r\n            //Buscar profissionais online\r\n            const professionals = await api.get('/getProfessionalsOn');\r\n            setUserOn(professionals.data);\r\n        });\r\n\r\n        requestLocationPermission();\r\n\r\n    }, []);\r\n\r\n\r\n    return (\r\n        <View style={styles.container}>\r\n\r\n            {\r\n                location && userOn &&\r\n\r\n                <MapView style={styles.map}\r\n                    region={{\r\n                        latitude: location.coords.latitude,\r\n                        longitude: location.coords.longitude,\r\n                        latitudeDelta: 0.0143,\r\n                        longitudeDelta: 0.00134\r\n                    }}\r\n                    loadingEnabled\r\n                    zoomEnabled={false}\r\n                >\r\n\r\n                    <Marker\r\n                        coordinate={{\r\n                            latitude: location.coords.latitude,\r\n                            longitude: location.coords.longitude\r\n                        }}\r\n                        pinColor=\"blue\"\r\n                    />\r\n\r\n                    {\r\n\r\n                        userOn.map((user) => (\r\n                            <Marker\r\n                                key={user.tb_profissional_id}\r\n                                coordinate={{\r\n                                    latitude: user.tb_profissional_latitude,\r\n                                    longitude: user.tb_profissional_longitude\r\n                                }}\r\n                                title={user.tb_profissional_nome}\r\n                            />\r\n                        ))\r\n                    }\r\n                </MapView>\r\n            }\r\n\r\n        </View>\r\n    )\r\n\r\n}\r\n\r\n\r\nconst styles = StyleSheet.create({\r\n    container: {\r\n        flex: 1,\r\n    },\r\n    map: {\r\n        width: '100%',\r\n        height: '100%',\r\n    },\r\n});"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}